import type { ResponsiveColumnType } from "xiilab-ui";

import { SecurityLevelText } from "@/shared/components/text/security-status-text";
import type { CoreSecurityLevel } from "@/shared/types/core.interface";
import type { CoreCreateColumnConfig } from "@/shared/types/core.model";
import { applyColumnConfigs } from "@/shared/utils/column.util";
import { ColumnAlignCenterWrap } from "@/styles/layers/column-layer.styled";

/**
 * 컬럼 정의 배열 생성 (dataIndex 한 번만 정의)
 */
const createColumnList = (): ResponsiveColumnType[] => {
  return [
    {
      title: "취약점",
      dataIndex: "cve",
      align: "left",
    },
    {
      title: "심각도",
      dataIndex: "severity",
      align: "center",
      render: (level: CoreSecurityLevel) => {
        return (
          <ColumnAlignCenterWrap>
            <SecurityLevelText type="engText" status={level} />
          </ColumnAlignCenterWrap>
        );
      },
    },
    {
      title: "nvd",
      dataIndex: "nvd",
      align: "center",
    },
    {
      title: "redhat",
      dataIndex: "redhat",
      align: "center",
    },
    {
      title: "패키지",
      dataIndex: "package",
      align: "center",
    },
    {
      title: "버전",
      dataIndex: "version",
      align: "left",
    },
    {
      title: "업데이트 버전",
      dataIndex: "updatedVersion",
      align: "left",
    },
  ];
};

/**
 * 취약점 목록 컬럼 생성
 *
 * @param config 컬럼 설정 (배열 형태)
 * @returns 컬럼 배열
 *
 * @example
 * // 1. 모든 컬럼 표시
 * const columns = createVulnerabilityColumn();
 *
 * @example
 * // 2. 배열 형태 - 순서 변경 가능
 * const columns = createVulnerabilityColumn([
 *   { dataIndex: 'cve' },
 *   { dataIndex: 'severity' },
 *   { dataIndex: 'package' },
 *   { dataIndex: 'version' },
 * ]);
 *
 */
export const createVulnerabilityColumn = (
  config?: CoreCreateColumnConfig[],
): ResponsiveColumnType[] => {
  const columnList = createColumnList();

  return applyColumnConfigs(columnList, config);
};

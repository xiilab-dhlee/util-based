import { z } from "zod";

// 취약점 스키마
const baseVulnerabilitySchema = z.object({
  /** 아이디 */
  id: z.string().uuid(),
  /** 취약점 */
  cve: z.string(),
  /** 보안 상태 */
  severity: z.enum(["ALL", "CRITICAL", "HIGH", "MEDIUM", "LOW"]),
  /** NVD 점수 */
  nvd: z.string(),
  /** RedHat 점수 */
  redhat: z.string(),
  /** 패키지 */
  package: z.string(),
  /** 버전 */
  version: z.string(),
  /** 업데이트된 버전 */
  updatedVersion: z.string(),
  /** 생성일시 */
  creatorDateTime: z.string().datetime(),
  /** 생성자 */
  creatorName: z.string(),
});

export const vulnerabilityListSchema = baseVulnerabilitySchema.pick({
  id: true,
  cve: true,
  severity: true,
  nvd: true,
  redhat: true,
  package: true,
  version: true,
  updatedVersion: true,
  creatorDateTime: true,
  creatorName: true,
});

export type VulnerabilityType = z.infer<typeof baseVulnerabilitySchema>;
export type VulnerabilityListType = z.infer<typeof vulnerabilityListSchema>;
export type VulnerabilitySeverityType = VulnerabilityType["severity"];
